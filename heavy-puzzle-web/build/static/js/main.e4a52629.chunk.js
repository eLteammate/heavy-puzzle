(this["webpackJsonpheavy-puzzle-web"]=this["webpackJsonpheavy-puzzle-web"]||[]).push([[0],{166:function(e,t,n){"use strict";n.r(t);var c=n(0),i=n.n(c),r=n(62),a=n.n(r),o=n(4),s=n(183),u=n(185),d=n(178),l=n(181),h=n(186),j=n(184),f=n(14),b=n(40),g=n(67),x=n(75),O=n(60),p={pieces:void 0},v=Object(x.b)({name:"puzzle",initialState:p,reducers:{set:function(e,t){e.pieces=t.payload}}}),m=function(e){return e.puzzle.pieces},y=v.reducer,w=Object(x.a)({reducer:{puzzle:y}}),k=O.c,z=n(111),S=Object(z.io)("http://207.154.244.40:8000/");console.log("http://207.154.244.40:8000/"),S.on("connect",(function(){console.log("connected")})),S.on("state",(function(e){console.log(e);var t=e.blocks;w.dispatch(v.actions.set(t))}));var X=void 0;setInterval((function(){X&&(S.emit(X.type,X.data),X=void 0)}),50);var Y=n(182),C=n(5);function F(e){var t,n=e.piece,c=e.selected;return Object(C.jsx)(Y.a.image,{animate:{x:n.x,y:n.y},transition:{duration:.5},imageRendering:"optimizeSpeed",strokeWidth:c?3:0,stroke:"black",href:(t=n.imageUrl,"http://207.154.244.40:8000/"+t),width:1.03*n.width,height:1.03*n.height})}function B(e){var t=Object(c.useRef)(null),n=Object(c.useContext)(P);return Object(g.useGesture)({onDrag:function(t){return n=e.id,c=t.offset[0],i=t.offset[1],void(X={type:"drag",data:{blockId:n,x:c,y:i}});var n,c,i},onDragEnd:function(){X={type:"release",data:{}}}},{target:t,drag:{from:function(){return[e.centerX,e.centerY]},transform:function(e){var t=Object(o.a)(e,2),c=t[0],i=t[1];return[c/n,i/n]},bounds:{top:50,bottom:950,left:50,right:950}}}),t}function R(e){var t=e.block,n=B(t);return Object(C.jsxs)(Y.a.g,{ref:n,style:{touchAction:"none"},children:[t.pieces.map((function(e){return Object(C.jsx)(Y.a.rect,{animate:{x:e.x,y:e.y},width:1.03*e.width,height:1.03*e.height,stroke:"white",strokeWidth:2,transition:{duration:.5}},-t.id)})),Object(f.a)(t.pieces).sort((function(e,t){return e.id-t.id})).map((function(e){return Object(C.jsx)(F,{selected:!0,piece:e},e.id)}))]})}function U(e){var t=e.block,n=B(t),c="hsl(".concat(1337*t.id%360," 100% 50%)");return Object(C.jsxs)(Y.a.g,{initial:{opacity:0},animate:{opacity:t.draggingUsers.length>0?1:0},transition:{duration:.15},ref:n,children:[t.draggingUsers.map((function(e){return Object(C.jsxs)(i.a.Fragment,{children:[Object(C.jsx)(Y.a.line,{x1:t.centerX,y1:t.centerY,initial:{x2:e.x,y2:e.y},animate:{x2:e.x,y2:e.y},transition:{duration:.5},stroke:c,strokeWidth:5,z:10},"l".concat(e.id)),Object(C.jsx)(Y.a.circle,{initial:{r:"0.1cm",cx:e.x,cy:e.y},animate:{r:"0.3cm",cx:e.x,cy:e.y},transition:{duration:.5},fill:c},"c".concat(e.id))]},e.id)})),Object(C.jsx)(Y.a.circle,{initial:{r:"0.1cm"},animate:{r:t.draggingUsers.length>0?"0.4cm":"0.1cm"},transition:{duration:.5},cx:t.centerX,cy:t.centerY,stroke:c,strokeWidth:6,fill:"white"},t.id+1e3),Object(C.jsx)(Y.a.circle,{initial:{r:"0.1cm"},animate:{r:"".concat(.33*t.draggingUsers.length/t.weight,"cm")},transition:{duration:.5},cx:t.centerX,cy:t.centerY,fill:c},-t.id)]},t.id)}var D=function(e,t,n){return e<t?t:e>n?n:e},E=1e3,I=function(e,t){var n,c,i=t.getBoundingClientRect(),r=e.scale,a=Math.max(i.width,i.height)/E*r,o=E/r;return i.width>i.height?c=(n=o)/i.width*i.height:n=(c=o)/i.height*i.width,{offsetX:D(e.offsetX,0,E-n),offsetY:D(e.offsetY,0,E-c),scale:r,trueScale:a,width:n,height:c}},P=i.a.createContext(1);function W(){var e=k(m),t=Object(c.useRef)(null),n=Object(c.useRef)(null),i=Object(c.useState)({offsetX:0,offsetY:0,scale:1,width:E,height:E,trueScale:void 0}),r=Object(o.a)(i,2),a=r[0],s=r[1];return Object(g.useGesture)({onDrag:function(e){var n=I(Object(b.a)(Object(b.a)({},a),{},{offsetX:a.offsetX-e.delta[0]/(a.trueScale||1),offsetY:a.offsetY-e.delta[1]/(a.trueScale||1)}),t.current);s(n)},onPinch:function(e){s(I(Object(b.a)(Object(b.a)({},a),{},{scale:e.offset[0]}),t.current))}},{target:n,pinch:{scaleBounds:[1,5]}}),Object(c.useEffect)((function(){return s(I(a,t.current))}),[]),Object(C.jsx)(P.Provider,{value:a.trueScale||1,children:Object(C.jsx)(d.a,{overflow:"hidden",h:"100vh",ref:t,children:Object(C.jsxs)(Y.a.svg,{animate:{viewBox:"\n                        ".concat(a.offsetX.toFixed(2)," \n                        ").concat(a.offsetY.toFixed(2)," \n                        ").concat(a.width," ").concat(a.height,"\n                        ")},style:{touchAction:"none"},children:[Object(C.jsx)("rect",{ref:n,width:1e3,height:1e3,fill:"#181818",style:{touchAction:"none"}}),Object(f.a)(e||[]).sort((function(e,t){return t.weight-e.weight})).map((function(e){return Object(C.jsx)(R,{block:e},e.id)})),null===e||void 0===e?void 0:e.map((function(e){return Object(C.jsx)(U,{block:e},e.id)}))]})})})}var A=n(179);var G=function(){var e=Object(c.useState)(!0),t=Object(o.a)(e,2),n=t[0],i=t[1];return Object(C.jsx)(O.a,{store:w,children:Object(C.jsx)(A.a,{transition:{ease:"linear"},children:Object(C.jsxs)(s.a,{children:[Object(C.jsx)(W,{}),Object(C.jsx)(u.a,{in:n,unmountOnExit:!0,children:Object(C.jsx)(d.a,{pos:"fixed",top:"0",left:"0",w:"100vw",h:"100vh",bg:"#ddd",children:Object(C.jsxs)(l.a,{m:2,children:[Object(C.jsxs)(h.b,{children:[Object(C.jsx)(h.a,{children:"\u041f\u0435\u0440\u0435\u0442\u044f\u0433\u0438\u0432\u0430\u0439\u0442\u0435 \u0434\u0435\u0442\u0430\u043b\u0438 \u043f\u0430\u0437\u043b\u0430 \u0434\u0440\u0443\u0433 \u043a \u0434\u0440\u0443\u0433\u0443"}),Object(C.jsx)(h.a,{children:"\u041a\u043e\u0433\u0434\u0430 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0435 \u043a\u0443\u0441\u043e\u0447\u043a\u0438 \u0440\u044f\u0434\u043e\u043c - \u043e\u043d\u0438 \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u044f\u0442\u0441\u044f"}),Object(C.jsx)(h.a,{children:"\u0427\u0435\u043c \u0431\u043e\u043b\u044c\u0448\u0435 \u043a\u0443\u0441\u043e\u0447\u0435\u043a, \u0442\u0435\u043c \u0441\u043b\u043e\u0436\u043d\u0435\u0435 \u0435\u0433\u043e \u0442\u0430\u0449\u0438\u0442\u044c"}),Object(C.jsx)(h.a,{children:"\u041e\u0431\u044a\u0435\u0434\u0438\u043d\u044f\u0439\u0442\u0435\u0441\u044c \u0441 \u0434\u0440\u0443\u0437\u044c\u044f\u043c\u0438, \u0447\u0442\u043e\u0431\u044b \u0441\u043e\u0431\u0440\u0430\u0442\u044c \u0432\u0435\u0441\u044c \u043f\u0430\u0437\u043b!"})]}),Object(C.jsx)(j.a,{onClick:function(){return i(!1)},children:"\u0412\u043f\u0435\u0440\u0435\u0434!"})]})})})]})})})},J=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,188)).then((function(t){var n=t.getCLS,c=t.getFID,i=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),c(e),i(e),r(e),a(e)}))};a.a.render(Object(C.jsx)(i.a.StrictMode,{children:Object(C.jsx)(G,{})}),document.getElementById("root")),J()}},[[166,1,2]]]);
//# sourceMappingURL=main.e4a52629.chunk.js.map